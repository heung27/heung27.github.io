<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Optional" /><meta property="og:locale" content="en" /><meta name="description" content="개발할 때 흔히 NPE(NullPointException)를 접하게 된다. null 값을 가진 객체를 참조하려고 할 때 발생하는 에러인데, NPE를 해결하기 위해서는 해당 객체가 null인지 검사하는 로직이 필요하다." /><meta property="og:description" content="개발할 때 흔히 NPE(NullPointException)를 접하게 된다. null 값을 가진 객체를 참조하려고 할 때 발생하는 에러인데, NPE를 해결하기 위해서는 해당 객체가 null인지 검사하는 로직이 필요하다." /><link rel="canonical" href="https://github.com/heung27/posts/optional/" /><meta property="og:url" content="https://github.com/heung27/posts/optional/" /><meta property="og:site_name" content="H’s Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-19T13:32:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Optional" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-22T00:19:31+09:00","datePublished":"2022-02-19T13:32:00+09:00","description":"개발할 때 흔히 NPE(NullPointException)를 접하게 된다. null 값을 가진 객체를 참조하려고 할 때 발생하는 에러인데, NPE를 해결하기 위해서는 해당 객체가 null인지 검사하는 로직이 필요하다.","headline":"Optional","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/heung27/posts/optional/"},"url":"https://github.com/heung27/posts/optional/"}</script><title>Optional | H's Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="H's Tech Blog"><meta name="application-name" content="H's Tech Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">H's Tech Blog</a></div><div class="site-subtitle font-italic">주니어 서버 개발자의 성장기</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/heung27" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wlsgmd1535','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Optional</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Optional</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/heung27">Jin Heung An</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1645245120" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-19 </em> </span> <span> Updated <em class="timeago" data-ts="1645456771" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-22 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2064 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p>개발할 때 흔히 NPE(NullPointException)를 접하게 된다. null 값을 가진 객체를 참조하려고 할 때 발생하는 에러인데, NPE를 해결하기 위해서는 해당 객체가 null인지 검사하는 로직이 필요하다.</p><p>하지만 코드가 복잡해지고 검사해야 할 변수가 많아질수록 검사 로직 구현이 상당히 번거로워진다. 본문에서 이를 쉽게 처리할 수 있도록 도와주는 Optional 클래스를 소개한다.</p><p><br /></p><h2 id="optional-이란">Optional 이란? <a href="#optional-이란" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Optional은 Integer나 Double처럼 T 타입의 객체를 포장해 주는 래퍼 클래스(Wrapper Class)이다. 따라서 Optional 인스턴스는 모든 타입의 참조 변수를 저장할 수 있다.</p><p>이러한 Optional 객체를 사용하면 제공되는 메서드로 예상치 못한 NPE을 간단히 회피할 수 있다. 즉, 복잡한 조건문 없이도 null 값으로 인해 발생하는 예외를 처리할 수 있게 된다.</p><p>참고로 Optional은 Java 8에서 추가되었다.</p><p><br /></p><h2 id="사용법">사용법 <a href="#사용법" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Optional의 주요 메소드를 정리했다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">메서드<th style="text-align: center">설명<tbody><tr><td style="text-align: center">static &lt;T&gt; Optional&lt;T&gt; empty()<td style="text-align: center">아무런 값도 가지지 않은 비어있는 Optional 객체를 반환한다.<tr><td style="text-align: center">T get()<td style="text-align: center">Optional 객체에 저장된 값을 반환한다.<tr><td style="text-align: center">boolean isPresent()<td style="text-align: center">저장된 값이 존재하면 true를 반환하고, 값이 존재하지 않으면 false를 반환한다.<tr><td style="text-align: center">static &lt;T&gt; Optional&lt;T&gt; of(T value)<td style="text-align: center">null이 아닌 명시된 값을 가지는 Optional 객체를 반환한다.<tr><td style="text-align: center">static &lt;T&gt; Optional&lt;T&gt; ofNullable(T value)<td style="text-align: center">명시된 값이 null이 아니면 그 값을 가지는 Optional 객체를 반환하고, 명시된 값이 null이면 비어있는 Optional 객체를 반환한다.<tr><td style="text-align: center">T orElse(T other)<td style="text-align: center">저장된 값이 존재하면 그 값을 반환하고, 값이 존재하지 않으면 인수로 전달된 값을 반환한다.<tr><td style="text-align: center">T orElseGet(Supplier&lt;? extends T&gt; other)<td style="text-align: center">저장된 값이 존재하면 그 값을 반환하고, 값이 존재하지 않으면 인수로 전달된 람다 표현식의 결괏값을 반환한다.<tr><td style="text-align: center">&lt;X extends Throwable&gt; T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier)<td style="text-align: center">저장된 값이 존재하면 그 값을 반환하고, 값이 존재하지 않으면 인수로 전달된 예외를 발생시킨다.<tr><td style="text-align: center">&lt;U&gt; Optional&lt;U&gt; map(Function&lt;? super T, ? extends U&gt; mapper)<td style="text-align: center">값이 있으면 제공된 매핑 함수를 적용하고, 결과가 null이 아니면 결과를 설명하는 Optional을 반환한다.</table></div><p>더 자세한 정보는 공식 문서를 참고하길 바란다.</p><p>공식 문서 : <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html">https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html</a></p><p><br /></p><h2 id="예제">예제 <a href="#예제" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>위에서 사용법을 알아봤으니 예제를 통해 자세한 활용 방법을 알아본다.</p><h3 id="1-생성">1. 생성 <a href="#1-생성" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>아무런 값도 가지지 않는 빈 객체는 아래와 같이 생성할 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">userName</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">userName</span><span class="o">);</span> <span class="c1">// Optional.empty</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">userName</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span> <span class="c1">// true</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">userName</span><span class="o">.</span><span class="na">isPresent</span><span class="o">());</span> <span class="c1">// false</span>
</pre></table></code></div></div><p><br /></p><p>값을 가지는 객체는 아래와 같이 생성할 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">// getNmae()이 null이면 NPE 발생</span>
<span class="c1">// null이 아니면 해당 문자열을 가지는 Optional 반환</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">optionalUser</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">getUser</span><span class="o">());</span>

<span class="c1">// getNmae()이 null이면 Optional.empty 반환</span>
<span class="c1">// null이 아니면 해당 문자열을 가지는 Optional 반환</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">optionalUser</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">getUser</span><span class="o">());</span>
</pre></table></code></div></div><p>메서드 of 또는 ofNullable을 사용한다. 메서드명에서도 알 수 있듯이 of는 값으로 null을 허용하지 않고, ofNullable은 null을 허용한다.</p><p><br /></p><h3 id="2-객체-사용">2. 객체 사용 <a href="#2-객체-사용" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Optional에 저장되어 있는 객체는 아래와 같이 꺼내 쓸 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// Optional에 저장된 값을 반환</span>
<span class="c1">// 비어있으면 NoSuchElementException 발생</span>
<span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">optionalUser</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>

<span class="c1">// Optional에 저장된 값이 있으면 해당 값 반환</span>
<span class="c1">// 비어있으면 대체하는 새로운 객체 반환(unknown User)</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">optionalUser</span><span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"unknown"</span><span class="o">));</span>

<span class="c1">// Optional에 저장된 값이 있으면 해당 값 반환</span>
<span class="c1">// 비어있으면 람다식의 결과값(unknown User)을 반환</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">optionalUser</span><span class="o">.</span><span class="na">orElseGet</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"unknown"</span><span class="o">));</span>

<span class="c1">// Optional에 저장된 값이 있으면 해당 값 반환</span>
<span class="c1">// 비어있으면 예외를 throw</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">optionalUser</span><span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">RuntimeException</span><span class="o">());</span>
</pre></table></code></div></div><p>위의 예제에서 orElse()와 orElseGet()는 어떤 차이가 있는지 의문이 들 수 있다. 겉으로는 똑같이 동작하지만 중요한 차이가 있다.</p><p>orElse()는 인자로 객체를 받는다. 위의 예제에서는 <code class="language-plaintext highlighter-rouge">new User("unknown")</code>을 전달했다. 해당 코드는 optionalUser가 가지고 있는 값의 유무와 관계없이 무조건 실행된다. 따라서 optionalUser가 비어있지 않은 경우 쓸모없는 새로운 객체가 생성이 돼 메모리가 낭비되는 것이다.</p><p>반면에 orElseGet()는 인자로 람다식을 받는다. 예제에서는 <code class="language-plaintext highlighter-rouge">() -&gt; new User("unknown")</code>을 전달했다. 해당 람다식는 optionalUser가 비어있을 때만 실행되도록 설계되어 있다. 따라서 optionalUser가 비어있지 않은 경우 새로운 객체가 생성되지도, 메모리가 낭비되지도 않는 것이다.</p><p><strong>정리하자면, 새 객체 생성이나 새로운 연산을 유발하지 않고 이미 생성된 값을 사용할 때는 orElse()를 사용해도 괜찮다. 하지만 이외의 경우에서는 orElseGet()를 사용하는 것이 유리하다.</strong></p><p><br /></p><h3 id="3-활용">3. 활용 <a href="#3-활용" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>간단한 활용 예제를 살펴 본다. 아래와 같이 어떤 사용자의 우편번호를 찾는 함수가 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">String</span> <span class="nf">findPostCode</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">getUser</span><span class="o">();</span>
  
    <span class="k">if</span> <span class="o">(</span><span class="n">user</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="na">getAddress</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">address</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">postCode</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">getPostCode</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">postCode</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">postCode</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="s">"우편번호 없음"</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>우편번호는 User가 가지고 있는 Address의 내부에 저장되어 있기 때문에, 해당 객체들이 null인지 검사하는 번거로운 작업이 추가되었다. (이러한 조건문이 없다면 NPE를 만날 수 있다)</p><p><br /></p><p>이제 위 함수를 Optional을 이용해 개선해 보자.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">String</span> <span class="nf">findPostCode</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">optionalUser</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">getUser</span><span class="o">());</span>
  
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Address</span><span class="o">&gt;</span> <span class="n">address</span> <span class="o">=</span> <span class="n">optionalUser</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">User:</span><span class="o">:</span><span class="n">getAddress</span><span class="o">);</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">postCode</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Address:</span><span class="o">:</span><span class="n">getPostCode</span><span class="o">);</span>
   	<span class="k">return</span> <span class="n">postCode</span><span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="s">"우편번호 없음"</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이렇게 조금은 더 정돈된 코드를 작성할 수 있다. (map이 어떤 동작을 하는지 모르겠다면 위의 주요 메서드 표를 확인하길 바란다)</p><p>메서드 체인을 사용하면 이 모든 과정을 한 줄로 작성할 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">String</span> <span class="nf">findPostCode</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">optionalUser</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">getUser</span><span class="o">());</span>

    <span class="k">return</span> <span class="n">optionalUser</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">User:</span><span class="o">:</span><span class="n">getAddress</span><span class="o">)</span>
        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">Address:</span><span class="o">:</span><span class="n">getPostCode</span><span class="o">)</span>
        <span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="s">"우편번호 없음"</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>처음과 비교해 보면 상당히 깔끔해졌다. 이렇게 Optional은 null을 쉽게 처리할 수 있을 뿐만 아니라, 생산성과 가독성도 올릴 수 있다.</p><p><br /></p><h2 id="주의할-점">주의할 점 <a href="#주의할-점" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>반환 값으로 null을 사용하는 것이 위험하기 때문에 등장한 것이 Optional이다. 때문에 반환형이 Optional인 메서드에서 Optional 객체 대신 null을 반환하는 것은 Optional의 도입 의도와 맞지 않다. null 대신 Optional.empty()를 반환하도록 해야한다.</p><p>Optional은 값을 Wrapping하고 다시 풀고, null일 경우에는 대체하는 함수를 호출하는 등의 오버헤드가 있어 성능 저하의 우려가 있다. 때문에 메소드의 반환 값이 절대 null이 아니라면 Optional을 사용하지 않는 것이 좋다.</p><p><strong>즉, Optional은 메소드의 결과가 null이 될 수 있으며, 클라이언트가 이 상황을 처리해야 할 때 사용해야 한다.</strong></p><p><br /></p><p>자세한 Optional의 올바른 사용법에 대해서는 좋은 자료가 있어 링크를 첨부한다.</p><p>더 깊이 공부하고 싶다면 읽어보는 것을 추천한다.</p><p>참고 링크 : <a href="https://www.latera.kr/blog/2019-07-02-effective-optional/#13-%EB%B3%80%ED%99%98%EC%97%90-map-%EA%B3%BC-flatmap-%EC%82%AC%EC%9A%A9%EC%9D%84-%EA%B3%A0%EB%A0%A4%ED%95%A0-%EA%B2%83">Optional 제대로 활용하기 - Increment</a></p><p><br /></p><h2 id="reference">Reference <a href="#reference" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="http://www.tcpschool.com/java/java_stream_optional">Optional 클래스 - TCP School</a><li><a href="https://homoefficio.github.io/2019/10/03/Java-Optional-%EB%B0%94%EB%A5%B4%EA%B2%8C-%EC%93%B0%EA%B8%B0/">Java Optional 바르게 쓰기 - HomoEfficio</a><li><a href="https://mangkyu.tistory.com/70">Optional 개념 및 사용법 - 망나니개발자</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/language/'>Language</a>, <a href='/categories/java/'>Java</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java-8/" class="post-tag no-text-decoration" >Java 8</a> <a href="/tags/optional/" class="post-tag no-text-decoration" >Optional</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-1 pt-1 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Optional - H&#39;s Tech Blog&amp;url=https://github.com/heung27/posts/optional/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Optional - H&#39;s Tech Blog&amp;u=https://github.com/heung27/posts/optional/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://github.com/heung27/posts/optional/&amp;text=Optional - H&#39;s Tech Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/item-21-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%8A%94-%EA%B5%AC%ED%98%84%ED%95%98%EB%8A%94-%EC%AA%BD%EC%9D%84-%EC%83%9D%EA%B0%81%ED%95%B4-%EC%84%A4%EA%B3%84%ED%95%98%EB%9D%BC/">Item 21. 인터페이스는 구현하는 쪽을 생각해 설계하라</a><li><a href="/posts/item-20-%EC%B6%94%EC%83%81-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%B3%B4%EB%8B%A4%EB%8A%94-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%A5%BC-%EC%9A%B0%EC%84%A0%ED%95%98%EB%9D%BC/">Item 20. 추상 클래스보다는 인터페이스를 우선하라</a><li><a href="/posts/item-19-%EC%83%81%EC%86%8D%EC%9D%84-%EA%B3%A0%EB%A0%A4%ED%95%B4-%EC%84%A4%EA%B3%84%ED%95%98%EA%B3%A0-%EB%AC%B8%EC%84%9C%ED%99%94%ED%95%98%EB%9D%BC-%EA%B7%B8%EB%9F%AC%EC%A7%80-%EC%95%8A%EC%95%98%EB%8B%A4%EB%A9%B4-%EC%83%81%EC%86%8D%EC%9D%84-%EA%B8%88%EC%A7%80%ED%95%98%EB%9D%BC/">Item 19. 상속을 고려해 설계하고 문서화하라. 그러지 않았다면 상속을 금지하라</a><li><a href="/posts/item-18-%EC%83%81%EC%86%8D%EB%B3%B4%EB%8B%A4%EB%8A%94-%EC%BB%B4%ED%8F%AC%EC%A7%80%EC%85%98%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC/">Item 18. 상속보다는 컴포지션을 사용하라</a><li><a href="/posts/item-17-%EB%B3%80%EA%B2%BD-%EA%B0%80%EB%8A%A5%EC%84%B1%EC%9D%84-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EB%9D%BC/">Item 17. 변경 가능성을 최소화하라</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/java-8/">Java 8</a> <a class="post-tag" href="/tags/override/">Override</a> <a class="post-tag" href="/tags/lambda/">Lambda</a> <a class="post-tag" href="/tags/method-reference/">Method Reference</a> <a class="post-tag" href="/tags/constructor/">Constructor</a> <a class="post-tag" href="/tags/functional-interface/">Functional Interface</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/interface/">Interface</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/stream-api-%EA%B8%B0%EB%B3%B8/"><div class="card-body"> <em class="timeago small" data-ts="1645624500" > 2022-02-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Stream API - 기본</h3><div class="text-muted small"><p> Stream API란? Stream API는 데이터를 추상화하고 처리하는데 자주 사용되는 함수들을 정의해둔 API이며 Java 8에서 추가되었다. 여기서 데이터를 추상화하였다는 것은 데이터의 종류와 관계없이 같은 방식으로 데이터를 처리할 수 있다는 것을 의미한다. Java 8 이전에는 배열 또는 컬렉션 인스턴스를 다루기 위해 for 또는 wh...</p></div></div></a></div><div class="card"> <a href="/posts/functional-interface/"><div class="card-body"> <em class="timeago small" data-ts="1645966200" > 2022-02-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Functional Interface</h3><div class="text-muted small"><p> Java는 함수형 프로그래밍 언어가 아닌 객체지향 언어이기 때문에 함수는 일급 객체가 아니다. 그러나 Java 8에서 추가된 Functional Interface(이하 함수형 인터페이스)를 사용하면 일급 객체처럼 다룰 수 있다. 본문에서 함수형 인터페이스에 대해 자세히 알아보자. 일급 객체(First-class citizen)란? 다른 ...</p></div></div></a></div><div class="card"> <a href="/posts/stream-api-%EA%B3%A0%EA%B8%89/"><div class="card-body"> <em class="timeago small" data-ts="1647157800" > 2022-03-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Stream API - 고급</h3><div class="text-muted small"><p> 지난번의 기본편에 이어 고급편을 준비했다. 본편에서는 조금 더 복잡한 Stream API 메서드들과 성능, 주의할 점에 대해 자세히 알아본다. 1. Parallel Stream Stream API는 많은 양의 데이터를 처리하는 경우 런타임 성능을 높이기 위해 병렬 스트림(Parallel Stream)을 제공한다. Parallel Stream는 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Bean-Validation/" class="btn btn-outline-primary" prompt="Older"><p>Bean Validation</p></a> <a href="/posts/stream-api-%EA%B8%B0%EB%B3%B8/" class="btn btn-outline-primary" prompt="Newer"><p>Stream API - 기본</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/heung27">Jin Heung An</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/java-8/">Java 8</a> <a class="post-tag" href="/tags/override/">Override</a> <a class="post-tag" href="/tags/lambda/">Lambda</a> <a class="post-tag" href="/tags/method-reference/">Method Reference</a> <a class="post-tag" href="/tags/constructor/">Constructor</a> <a class="post-tag" href="/tags/functional-interface/">Functional Interface</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/interface/">Interface</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-J2QJ5KLVPE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-J2QJ5KLVPE'); }); </script>
