<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Item 7. 다 쓴 객체 참조를 해제하라" /><meta property="og:locale" content="en" /><meta name="description" content="Effective Java의 일곱 번째 아이템 “다 쓴 객체 참조를 해제하라”를 읽고 정리한 내용을 포스팅합니다." /><meta property="og:description" content="Effective Java의 일곱 번째 아이템 “다 쓴 객체 참조를 해제하라”를 읽고 정리한 내용을 포스팅합니다." /><link rel="canonical" href="https://github.com/heung27/posts/item-7-%EB%8B%A4-%EC%93%B4-%EA%B0%9D%EC%B2%B4-%EC%B0%B8%EC%A1%B0%EB%A5%BC-%ED%95%B4%EC%A0%9C%ED%95%98%EB%9D%BC/" /><meta property="og:url" content="https://github.com/heung27/posts/item-7-%EB%8B%A4-%EC%93%B4-%EA%B0%9D%EC%B2%B4-%EC%B0%B8%EC%A1%B0%EB%A5%BC-%ED%95%B4%EC%A0%9C%ED%95%98%EB%9D%BC/" /><meta property="og:site_name" content="H’s Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-27T00:04:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Item 7. 다 쓴 객체 참조를 해제하라" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-30T14:35:56+09:00","datePublished":"2022-04-27T00:04:00+09:00","description":"Effective Java의 일곱 번째 아이템 “다 쓴 객체 참조를 해제하라”를 읽고 정리한 내용을 포스팅합니다.","headline":"Item 7. 다 쓴 객체 참조를 해제하라","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/heung27/posts/item-7-%EB%8B%A4-%EC%93%B4-%EA%B0%9D%EC%B2%B4-%EC%B0%B8%EC%A1%B0%EB%A5%BC-%ED%95%B4%EC%A0%9C%ED%95%98%EB%9D%BC/"},"url":"https://github.com/heung27/posts/item-7-%EB%8B%A4-%EC%93%B4-%EA%B0%9D%EC%B2%B4-%EC%B0%B8%EC%A1%B0%EB%A5%BC-%ED%95%B4%EC%A0%9C%ED%95%98%EB%9D%BC/"}</script><title>Item 7. 다 쓴 객체 참조를 해제하라 | H's Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="H's Tech Blog"><meta name="application-name" content="H's Tech Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/me.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">H's Tech Blog</a></div><div class="site-subtitle font-italic">주니어 서버 개발자의 성장기</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/heung27" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wlsgmd1535','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Item 7. 다 쓴 객체 참조를 해제하라</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Item 7. 다 쓴 객체 참조를 해제하라</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/heung27">Jin Heung An</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1650985440" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-27 </em> </span> <span> Updated <em class="timeago" data-ts="1651296956" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-30 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2891 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><p>Effective Java의 일곱 번째 아이템 “다 쓴 객체 참조를 해제하라”를 읽고 정리한 내용을 포스팅합니다.</p><p><br /></p><h2 id="0-들어가며">0. 들어가며 <a href="#0-들어가며" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>자바는 다 쓴 객체를 <strong>GC(Garbage Collector)</strong>가 알아서 회수해 갑니다. 그래서 자칫 메모리 관리에 더 이상 신경 쓰지 않아도 된다고 오해할 수 있는데, 이는 절대 사실이 아닙니다. 가비지 컬렉션 언어에서는 의도치 않게 객체를 살려두는 ‘<strong>메모리 누수</strong>‘를 찾기가 아주 까다롭습니다. 객체 참조 하나를 살려두면 GC는 그 객체뿐 아니라 그 객체가 참조하는 모든 객체(그리고 또 그 객체들이 참조하는 모든 객체)를 회수해가지 못합니다. 때문에 단 몇 개의 객체가 매우 많은 객체를 회수하지 못하게 할 수 있고 잠재적으로 성능에 악영향을 줄 수 있습니다.</p><p>본문에서 다 쓴 참조(앞으로 다시 쓰지 않을 참조)가 해제되지 않아 메모리 누수가 발생하는 예와 해결 방법을 알아보겠습니다.</p><p><br /></p><h2 id="1-메모리-누수-예">1. 메모리 누수 예 <a href="#1-메모리-누수-예" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>CG가 알아서 다 쓴 객체를 회수해가는데 왜 메모리 누수가 발생하는 걸까요? 원인은 프로그래머가 작성한 클래스에 있습니다. 어떤 <strong>클래스가 자기 메모리를 직접 관리</strong>한다면, GC는 해당 메모리가 더 이상 쓸 일이 없는 참조라는 것을 인식하지 못하게 될 수 있습니다. 따라서 여전히 다 쓴 참조가 해제되지 않고 메모리 누수가 발생하는 것입니다. 세 가지 예제를 통해 자세히 알아보겠습니다.</p><h3 id="11-스택">1.1 스택 <a href="#11-스택" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>스택은 아시다시피 후입선출 방식의 자료구조입니다. java.util 패키지에서 구현체를 제공해 주지만, 메모리 누수가 발생하는 상황을 만들기 위해 직접 구현했습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Stack</span> <span class="o">{</span>
  
    <span class="kd">private</span> <span class="nc">Object</span><span class="o">[]</span> <span class="n">elements</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">DEFAULT_INITIAL_CAPACITY</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Stack</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="no">DEFAULT_INITIAL_CAPACITY</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="nc">Object</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ensureCapacity</span><span class="o">();</span>
        <span class="n">elements</span><span class="o">[</span><span class="n">size</span><span class="o">++]</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">EmptyStackException</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">elements</span><span class="o">[--</span><span class="n">size</span><span class="o">];</span>
    <span class="o">}</span>
  
    <span class="cm">/**
     * 원소를 위한 공간을 적어도 하나 이상 확보한다.
     * 배열 크기를 늘려야 할 때마다 대략 두 배씩 늘린다.
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">ensureCapacity</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">elements</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="n">size</span><span class="o">)</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">elements</span><span class="o">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>위 예제에서는 스택에 원소가 쌓였다가(push) 꺼내질 때(pop) 메모리 누수가 일어납니다. 더 이상 사용되지 않을 꺼내진 객체들을 GC는 회수하지 않습니다. 그 이유는 스택이 해당 객체들의 다 쓴 참조를 여전히 가지고 있기 때문입니다. 위의 예제에서는 elements 배열의 ‘활성 영역’ 밖의 참조들이 모두 여기에 해당합니다. 여기서 활성 영역은 size보다 작은 인덱스를 말합니다.</p><p>이를 해결하기 위한 방법은 간단합니다. 해당 <strong>참조를 다 썼을 때 null 처리(참조 해제)</strong>해주면 됩니다. 다음은 pop 메서드를 개선한 코드입니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="nc">Object</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">EmptyStackException</span><span class="o">();</span>
  <span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">elements</span><span class="o">[--</span><span class="n">size</span><span class="o">];</span>
  <span class="n">elements</span><span class="o">[</span><span class="n">size</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">// 다 쓴 참조 해제</span>
  <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>예제의 Stack 클래스는 왜 null 처리가 필요한 걸까요? 이유는 elements 배열로 저장소 풀을 만들어 원소들을 관리(자기 메모리를 직접 관리)하기 때문입니다. 배열의 활성 영역에 속한 원소들이 사용되고 비활성 영역은 쓰이지 않습니다. 문제는 GC가 이 사실을 알 길이 없다는 것입니다. <strong>GC의 관점에서는 비활성 영역에서 참조하는 객체도 똑같이 유효한 객체입니다.</strong> 비활성 영역의 객체가 더 이상 쓸모없다는 것은 프로그래머만 아는 사실입니다. 때문에 프로그래머는 비활성 영역이 되는 순간 null 처리해서 해당 객체는 더 이상 쓰지 않을 것임을 GC에 알려야 합니다.</p><p><br /></p><h3 id="12-캐시">1.2 캐시 <a href="#12-캐시" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>캐시 역시 메모리 누수를 일으키는 주범입니다. 객체 참조를 캐시에 넣고 나서, 이 사실을 까맣게 잊은 채 그 객체를 다 쓴 뒤로도 한참을 그냥 놔두는 일을 자주 접할 수 있습니다. 다음은 캐시를 사용한 예제입니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CacheKey</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">value</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">created</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">CacheKey</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">created</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span> <span class="o">==</span> <span class="n">o</span><span class="o">)</span> <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">getClass</span><span class="o">()</span> <span class="o">!=</span> <span class="n">o</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="nc">CacheKey</span> <span class="n">cacheKey</span> <span class="o">=</span> <span class="o">(</span><span class="nc">CacheKey</span><span class="o">)</span> <span class="n">o</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">cacheKey</span><span class="o">.</span><span class="na">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">hash</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Post</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>CacheKey 클래스는 캐시의 key로 사용되고 Post 클래스는 캐싱된 value로 사용됩니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PostRepository</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">CacheKey</span><span class="o">,</span> <span class="nc">Post</span><span class="o">&gt;</span> <span class="n">cache</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">PostRepository</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Post</span> <span class="nf">getPostById</span><span class="o">(</span><span class="nc">CacheKey</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">cache</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">cache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="c1">// TODO DB에서 읽어오거나 REST API를 통해 Post 검색</span>
            <span class="nc">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Post</span><span class="o">();</span> <span class="c1">// 검색된 Post</span>
            <span class="n">cache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">post</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">post</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">CacheKey</span><span class="o">,</span> <span class="nc">Post</span><span class="o">&gt;</span> <span class="nf">getCache</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">cache</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Repository는 실제 캐싱이 되는 부분입니다. getPostById 메서드는 캐시에서 해당 key가 이미 존재하는지 확인합니다. 존재하지 않으면 DB나 다른 API를 통해 Post를 얻고 캐시에 저장합니다. 여기서 캐시는 HashMap을 사용했습니다.</p><p>다음은 Post를 조회하는 클라이언트 코드입니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="nc">PostRepository</span> <span class="n">postRepository</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostRepository</span><span class="o">();</span>
<span class="nc">CacheKey</span> <span class="n">cacheKey</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheKey</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="nc">CacheKey</span> <span class="n">newCacheKey</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheKey</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="nc">Post</span> <span class="n">post1</span> <span class="o">=</span> <span class="n">postRepository</span><span class="o">.</span><span class="na">getPostById</span><span class="o">(</span><span class="n">cacheKey</span><span class="o">);</span>
<span class="nc">Post</span> <span class="n">post2</span> <span class="o">=</span> <span class="n">postRepository</span><span class="o">.</span><span class="na">getPostById</span><span class="o">(</span><span class="n">newCacheKey</span><span class="o">);</span> <span class="c1">// post1과 post2는 같은 인스턴스 (캐시)</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">postRepository</span><span class="o">.</span><span class="na">getCache</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"run GC"</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">gc</span><span class="o">();</span> <span class="c1">// GC 동작</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"wait"</span><span class="o">);</span>
<span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">postRepository</span><span class="o">.</span><span class="na">getCache</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>

<span class="cm">/* 실행 결과
cache size : 1
run GC
wait
cache size : 1
*/</span>
</pre></table></code></div></div><p>처음 getPostById 메서드를 실행했을 때, CacheKey(1)을 key로 하여 새로운 Post 참조가 캐싱됩니다. 그리고 두 번째 getPostById에서 역시 동일한 값을 가지는 key로 조회하였기 때문에 캐싱된 Post 참조가 반환됩니다. 캐시에는 하나의 참조가 캐싱된 것이기 때문에 size는 1입니다.</p><p>다음, 명시적으로 GC를 실행시켰습니다. 그리고 다시 캐시 size를 확인해 보면 당연히 1인 것을 알 수 있습니다. 아무런 문제가 없어 보입니다. 그런데 <strong>만약 CacheKey(1)를 더 이상 쓸 일이 없고 프로그래머가 이를 잊었다면 어떨까요?</strong> 캐싱되어 있는 참조가 계속 남아서 메모리를 차지할 것입니다.</p><p>이를 해결하는 방법은 여러 가지인데, 위의 예제처럼 운 좋게 캐시 외부에서 key를 참조하는 동안만 엔트리가 살아 있는 캐시가 필요한 상황이라면 <strong>WeakHashMap</strong>을 사용해 캐시를 만드는 것을 권장합니다. 다 쓴 엔트리는 그 즉시 자동으로 제거될 것입니다. 단, WeakHashMap은 이러한 상황에서만 유용하다는 사실을 기억해야 합니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PostRepository</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">CacheKey</span><span class="o">,</span> <span class="nc">Post</span><span class="o">&gt;</span> <span class="n">cache</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">PostRepository</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WeakHashMap</span><span class="o">&lt;&gt;();</span> <span class="c1">// HashMap -&gt; WeakHashMap</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Post</span> <span class="nf">getPostById</span><span class="o">(</span><span class="nc">CacheKey</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">cache</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">cache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="c1">// TODO DB에서 읽어오거나 REST API를 통해 Post 검색</span>
            <span class="nc">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Post</span><span class="o">();</span>
            <span class="n">cache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">post</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">post</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">CacheKey</span><span class="o">,</span> <span class="nc">Post</span><span class="o">&gt;</span> <span class="nf">getCache</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">cache</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nc">PostRepository</span> <span class="n">postRepository</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostRepository</span><span class="o">();</span>
<span class="nc">CacheKey</span> <span class="n">cacheKey</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheKey</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="nc">CacheKey</span> <span class="n">newCacheKey</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheKey</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="nc">Post</span> <span class="n">post1</span> <span class="o">=</span> <span class="n">postRepository</span><span class="o">.</span><span class="na">getPostById</span><span class="o">(</span><span class="n">cacheKey</span><span class="o">);</span>
<span class="nc">Post</span> <span class="n">post2</span> <span class="o">=</span> <span class="n">postRepository</span><span class="o">.</span><span class="na">getPostById</span><span class="o">(</span><span class="n">newCacheKey</span><span class="o">);</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"cache size : "</span> <span class="o">+</span> <span class="n">postRepository</span><span class="o">.</span><span class="na">getCache</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>

<span class="n">cacheKey</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">// 참조 해제</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"run GC"</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">gc</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"wait"</span><span class="o">);</span>
<span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"cache size : "</span> <span class="o">+</span> <span class="n">postRepository</span><span class="o">.</span><span class="na">getCache</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>

<span class="cm">/* 실행 결과
cache size : 1
run GC
wait
cache size : 0
*/</span>
</pre></table></code></div></div><p>클라이언트 코드를 보면 <code class="language-plaintext highlighter-rouge">cacheKey = null;</code>가 추가되었습니다. 캐싱되어 있는 참조가 더 이상 쓸 일이 없기 때문에, null로 처리해 주어 참조를 해제하는 부분입니다. WeakHashMap는 다 쓴 엔트리를 제거한다고 했습니다. 따라서 GC가 동작할 때 캐싱되어 있는 참조 중 사용되지 않는 참조가 제거됩니다. 때문에 실행 결과는 GC가 동작한 후의 size가 0이 나오게 된 것입니다.</p><p><br /></p><p>캐시를 만들 때 보통은 캐시 엔트리의 유효 기간을 정확히 정의하기 어렵기 때문에 시간이 지날수록 엔트리의 가치를 떨어뜨리는 방식을 흔히 사용합니다. 이런 방식에서는 쓰지 않는 엔트리를 이따금 청소해 줘야 합니다. (Scheduled ThreadPoolExecutor 같은) 백그라운드 스레드를 활용하거나 캐시에 새 엔트리를 추가할 때 부수 작업으로 수행하는 방법이 있습니다. LinkedHashMap은 removeEldestEntry 메서드를 써서 후자의 방식으로 처리합니다. 더 복잡한 캐시를 만들고 싶다면 java.lang.ref 패키지를 직접 활용해야 합니다.</p><p><br /></p><h3 id="13-리스너와-콜백">1.3 리스너와 콜백 <a href="#13-리스너와-콜백" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>리스너와 콜백도 캐시처럼 메모리 어딘가에 저장되어야 합니다. 클라이언트가 리스너 또는 콜백을 등록만 하고 명확히 해지하지 않는다면, 뭔가 조치해 주지 않는 한 계속 쌓여갈 것입니다. 이럴 때 콜백을 약한 참조(weak reference)로 저장하면 GC가 즉시 수거해갑니다. 예를 들어 위에서 언급했던 WeakHashMap에 key로 저장하면 됩니다. 로직이 동일하기 때문에 예제 코드는 생략하겠습니다.</p><p><br /></p><h2 id="2-핵심-정리">2. 핵심 정리 <a href="#2-핵심-정리" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>책에서 소개한 메모리 누수의 예는 스택, 캐시, 리스너와 콜백 이렇게 세 가지이다. 그리고 해결 방법으로는 직접 null 처리, 특정한 자료구조 사용, 백그라운드 스레드 사용 이렇게 세 가지가 있다.</p><p>메모리 누수는 겉으로 잘 드러나지 않아 시스템에 수년간 잠복하는 사례도 있다. 이런 누수는 철저한 코드 리뷰나 힙 프로파일러 같은 디버깅 도구를 동원해야만 발견되기도 한다. 그래서 이런 종류의 문제는 예방법을 익혀두는 것이 매우 중요하다.</p><p><br /></p><h2 id="3-related-posts">3. Related Posts <a href="#3-related-posts" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>변수의 범위 (Item 57)</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/book/'>Book</a>, <a href='/categories/effective-java/'>Effective Java</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >Java</a> <a href="/tags/effective-java/" class="post-tag no-text-decoration" >Effective Java</a> <a href="/tags/memory-leak/" class="post-tag no-text-decoration" >Memory Leak</a> <a href="/tags/stack/" class="post-tag no-text-decoration" >Stack</a> <a href="/tags/cache/" class="post-tag no-text-decoration" >Cache</a> <a href="/tags/listner/" class="post-tag no-text-decoration" >Listner</a> <a href="/tags/callback/" class="post-tag no-text-decoration" >Callback</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-1 pt-1 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Item 7. 다 쓴 객체 참조를 해제하라 - H&#39;s Tech Blog&amp;url=https://github.com/heung27/posts/item-7-%EB%8B%A4-%EC%93%B4-%EA%B0%9D%EC%B2%B4-%EC%B0%B8%EC%A1%B0%EB%A5%BC-%ED%95%B4%EC%A0%9C%ED%95%98%EB%9D%BC/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Item 7. 다 쓴 객체 참조를 해제하라 - H&#39;s Tech Blog&amp;u=https://github.com/heung27/posts/item-7-%EB%8B%A4-%EC%93%B4-%EA%B0%9D%EC%B2%B4-%EC%B0%B8%EC%A1%B0%EB%A5%BC-%ED%95%B4%EC%A0%9C%ED%95%98%EB%9D%BC/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://github.com/heung27/posts/item-7-%EB%8B%A4-%EC%93%B4-%EA%B0%9D%EC%B2%B4-%EC%B0%B8%EC%A1%B0%EB%A5%BC-%ED%95%B4%EC%A0%9C%ED%95%98%EB%9D%BC/&amp;text=Item 7. 다 쓴 객체 참조를 해제하라 - H&#39;s Tech Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/item-21-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%8A%94-%EA%B5%AC%ED%98%84%ED%95%98%EB%8A%94-%EC%AA%BD%EC%9D%84-%EC%83%9D%EA%B0%81%ED%95%B4-%EC%84%A4%EA%B3%84%ED%95%98%EB%9D%BC/">Item 21. 인터페이스는 구현하는 쪽을 생각해 설계하라</a><li><a href="/posts/item-20-%EC%B6%94%EC%83%81-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%B3%B4%EB%8B%A4%EB%8A%94-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%A5%BC-%EC%9A%B0%EC%84%A0%ED%95%98%EB%9D%BC/">Item 20. 추상 클래스보다는 인터페이스를 우선하라</a><li><a href="/posts/item-19-%EC%83%81%EC%86%8D%EC%9D%84-%EA%B3%A0%EB%A0%A4%ED%95%B4-%EC%84%A4%EA%B3%84%ED%95%98%EA%B3%A0-%EB%AC%B8%EC%84%9C%ED%99%94%ED%95%98%EB%9D%BC-%EA%B7%B8%EB%9F%AC%EC%A7%80-%EC%95%8A%EC%95%98%EB%8B%A4%EB%A9%B4-%EC%83%81%EC%86%8D%EC%9D%84-%EA%B8%88%EC%A7%80%ED%95%98%EB%9D%BC/">Item 19. 상속을 고려해 설계하고 문서화하라. 그러지 않았다면 상속을 금지하라</a><li><a href="/posts/item-18-%EC%83%81%EC%86%8D%EB%B3%B4%EB%8B%A4%EB%8A%94-%EC%BB%B4%ED%8F%AC%EC%A7%80%EC%85%98%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC/">Item 18. 상속보다는 컴포지션을 사용하라</a><li><a href="/posts/item-17-%EB%B3%80%EA%B2%BD-%EA%B0%80%EB%8A%A5%EC%84%B1%EC%9D%84-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EB%9D%BC/">Item 17. 변경 가능성을 최소화하라</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/java-8/">Java 8</a> <a class="post-tag" href="/tags/override/">Override</a> <a class="post-tag" href="/tags/lambda/">Lambda</a> <a class="post-tag" href="/tags/method-reference/">Method Reference</a> <a class="post-tag" href="/tags/constructor/">Constructor</a> <a class="post-tag" href="/tags/functional-interface/">Functional Interface</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/interface/">Interface</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/item-15-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%99%80-%EB%A9%A4%EB%B2%84%EC%9D%98-%EC%A0%91%EA%B7%BC-%EA%B6%8C%ED%95%9C%EC%9D%84-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EB%9D%BC/"><div class="card-body"> <em class="timeago small" data-ts="1655044020" > 2022-06-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Item 15. 클래스와 멤버의 접근 권한을 최소화하라</h3><div class="text-muted small"><p> Effective Java의 열다섯 번째 아이템 “클래스와 멤버의 접근 권한을 최소화하라”를 읽고 정리한 내용을 포스팅합니다. 0. 들어가며 어설프게 설계된 컴포넌트와 잘 설계된 컴포넌트의 가장 큰 차이는 클래스 내부 데이터와 내부 구현 정보를 외부 컴포넌트로부터 얼마나 잘 숨겼느냐입니다. 잘 설계되 컴포넌트는 모든 내부 구현을 완벽히 숨겨,...</p></div></div></a></div><div class="card"> <a href="/posts/item-16-public-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%97%90%EC%84%9C%EB%8A%94-public-%ED%95%84%EB%93%9C%EA%B0%80-%EC%95%84%EB%8B%8C-%EC%A0%91%EA%B7%BC%EC%9E%90-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC/"><div class="card-body"> <em class="timeago small" data-ts="1655194320" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Item 16. public 클래스에서는 public 필드가 아닌 접근자 메서드를 사용하라</h3><div class="text-muted small"><p> Effective Java의 열여섯 번째 아이템 “public 클래스에서는 public 필드가 아닌 접근자 메서드를 사용하라”를 읽고 정리한 내용을 포스팅합니다. 0. 들어가며 이번 주제는 이전 포스팅과 상당히 밀접한 내용입니다. 이전에 public 클래스의 인스턴스는 되도록 public이 아니어야 한다고 했는데요. 여기에 초점을 맞춰 자세히 ...</p></div></div></a></div><div class="card"> <a href="/posts/item-17-%EB%B3%80%EA%B2%BD-%EA%B0%80%EB%8A%A5%EC%84%B1%EC%9D%84-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EB%9D%BC/"><div class="card-body"> <em class="timeago small" data-ts="1655302500" > 2022-06-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Item 17. 변경 가능성을 최소화하라</h3><div class="text-muted small"><p> Effective Java의 열일곱 번째 아이템 “변경 가능성을 최소화하라”를 읽고 정리한 내용을 포스팅합니다. 1. 불변 클래스 불변 클래스란 인스턴스의 내부 값을 수정할 수 없는 클래스를 말한다. 불변 인스턴스에 간직된 정보는 고정되어 객체가 파괴되는 순간까지 절대 달라지지 않는다. String, 기본 타입의 박싱된 클래스들, BigInte...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/item-6-%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C-%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1%EC%9D%84-%ED%94%BC%ED%95%98%EB%9D%BC/" class="btn btn-outline-primary" prompt="Older"><p>Item 6. 불필요한 객체 생성을 피하라</p></a> <a href="/posts/item-8-finalizer%EC%99%80-cleaner-%EC%82%AC%EC%9A%A9%EC%9D%84-%ED%94%BC%ED%95%98%EB%9D%BC/" class="btn btn-outline-primary" prompt="Newer"><p>Item 8. finalizer와 cleaner 사용을 피하라</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/heung27">Jin Heung An</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/java-8/">Java 8</a> <a class="post-tag" href="/tags/override/">Override</a> <a class="post-tag" href="/tags/lambda/">Lambda</a> <a class="post-tag" href="/tags/method-reference/">Method Reference</a> <a class="post-tag" href="/tags/constructor/">Constructor</a> <a class="post-tag" href="/tags/functional-interface/">Functional Interface</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/interface/">Interface</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-J2QJ5KLVPE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-J2QJ5KLVPE'); }); </script>
